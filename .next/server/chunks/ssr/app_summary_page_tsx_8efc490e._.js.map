{"version":3,"sources":["turbopack:///[project]/app/summary/page.tsx","turbopack:///[project]/components/UsageSummary.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useSearchParams } from 'next/navigation';\r\nimport { Suspense } from 'react';\r\nimport UsageSummary from '@/components/UsageSummary';\r\n\r\nfunction SummaryContent() {\r\n  const searchParams = useSearchParams();\r\n\r\n  const sessionId = searchParams.get('sessionId') || '';\r\n  const totalCharge = parseFloat(searchParams.get('charge') || '0');\r\n  const duration = parseInt(searchParams.get('duration') || '0');\r\n  const contentTitle = searchParams.get('title') || 'Content';\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-zinc-900 dark:to-zinc-800\">\r\n      <div className=\"container mx-auto px-4 py-8\">\r\n        <UsageSummary\r\n          sessionId={sessionId}\r\n          totalCharge={totalCharge}\r\n          duration={duration}\r\n          contentTitle={contentTitle}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function SummaryPage() {\r\n  return (\r\n    <Suspense fallback={<div className=\"min-h-screen flex items-center justify-center\">Loading...</div>}>\r\n      <SummaryContent />\r\n    </Suspense>\r\n  );\r\n}\r\n\r\n","'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { getBilling, getAnalytics, getWallet, getWalletConnect } from '@/lib/sdk';\r\nimport { appConfig } from '@/lib/config';\r\nimport Link from 'next/link';\r\n\r\ninterface UsageSummaryProps {\r\n  sessionId: string;\r\n  totalCharge: number;\r\n  duration: number; // in seconds\r\n  contentTitle: string;\r\n}\r\n\r\nexport default function UsageSummary({\r\n  sessionId,\r\n  totalCharge,\r\n  duration,\r\n  contentTitle,\r\n}: UsageSummaryProps) {\r\n  const [balance, setBalance] = useState<string>('0');\r\n  const [loading, setLoading] = useState(false);\r\n  const [sessionDetails, setSessionDetails] = useState<any>(null);\r\n\r\n  useEffect(() => {\r\n    loadSessionDetails();\r\n    updateBalance();\r\n  }, [sessionId]);\r\n\r\n  async function loadSessionDetails() {\r\n    try {\r\n      const b = await getBilling();\r\n      const details = await b.getSession(sessionId);\r\n      setSessionDetails(details);\r\n    } catch (err) {\r\n      console.error('Error loading session details:', err);\r\n    }\r\n  }\r\n\r\n  async function updateBalance() {\r\n    const wc = await getWalletConnect();\r\n    const address = wc.getConnectedAddress();\r\n    if (!address) return;\r\n\r\n    try {\r\n      const w = await getWallet();\r\n      const bal = await w.getBalance(address, appConfig.asaId);\r\n      setBalance(bal.formatted || '0');\r\n    } catch (err) {\r\n      console.error('Error updating balance:', err);\r\n    }\r\n  }\r\n\r\n  function formatTime(seconds: number): string {\r\n    const mins = Math.floor(seconds / 60);\r\n    const secs = seconds % 60;\r\n    return `${mins} minute${mins !== 1 ? 's' : ''} ${secs} second${secs !== 1 ? 's' : ''}`;\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex flex-col gap-6 rounded-lg border border-zinc-200 bg-white p-6 dark:border-zinc-800 dark:bg-zinc-900\">\r\n      <div className=\"text-center\">\r\n        <h2 className=\"text-2xl font-bold text-zinc-900 dark:text-zinc-100\">\r\n          Session Complete\r\n        </h2>\r\n        <p className=\"mt-2 text-zinc-600 dark:text-zinc-400\">{contentTitle}</p>\r\n      </div>\r\n\r\n      {/* Summary Cards */}\r\n      <div className=\"grid grid-cols-1 gap-4 md:grid-cols-3\">\r\n        <div className=\"rounded-lg bg-blue-50 p-4 dark:bg-blue-900/20\">\r\n          <div className=\"text-sm text-zinc-600 dark:text-zinc-400\">Duration</div>\r\n          <div className=\"mt-1 text-2xl font-bold text-zinc-900 dark:text-zinc-100\">\r\n            {formatTime(duration)}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"rounded-lg bg-green-50 p-4 dark:bg-green-900/20\">\r\n          <div className=\"text-sm text-zinc-600 dark:text-zinc-400\">Total Charge</div>\r\n          <div className=\"mt-1 text-2xl font-bold text-zinc-900 dark:text-zinc-100\">\r\n            â‚¬{totalCharge.toFixed(2)}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"rounded-lg bg-purple-50 p-4 dark:bg-purple-900/20\">\r\n          <div className=\"text-sm text-zinc-600 dark:text-zinc-400\">Remaining Balance</div>\r\n          <div className=\"mt-1 text-2xl font-bold text-zinc-900 dark:text-zinc-100\">\r\n            {balance} PLY\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Session Details */}\r\n      {sessionDetails && (\r\n        <div className=\"rounded-lg border border-zinc-200 bg-zinc-50 p-4 dark:border-zinc-800 dark:bg-zinc-900\">\r\n          <h3 className=\"mb-2 font-semibold text-zinc-900 dark:text-zinc-100\">\r\n            Session Details\r\n          </h3>\r\n          <div className=\"space-y-1 text-sm text-zinc-600 dark:text-zinc-400\">\r\n            <div>Session ID: {sessionId.slice(0, 8)}...</div>\r\n            <div>Started: {new Date(sessionDetails.startTime).toLocaleString()}</div>\r\n            {sessionDetails.endTime && (\r\n              <div>Ended: {new Date(sessionDetails.endTime).toLocaleString()}</div>\r\n            )}\r\n            <div>Total Ticks: {sessionDetails.tickCount || 0}</div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Actions */}\r\n      <div className=\"flex flex-col gap-2 sm:flex-row\">\r\n        <Link\r\n          href=\"/\"\r\n          className=\"flex-1 rounded-lg bg-zinc-200 px-6 py-3 text-center font-medium text-zinc-900 transition-colors hover:bg-zinc-300 dark:bg-zinc-800 dark:text-zinc-100 dark:hover:bg-zinc-700\"\r\n        >\r\n          Back to Home\r\n        </Link>\r\n        <button\r\n          onClick={() => {\r\n            // TODO: Implement add credit functionality\r\n            alert('Add Credit functionality coming soon!');\r\n          }}\r\n          className=\"flex-1 rounded-lg bg-blue-500 px-6 py-3 font-medium text-white transition-colors hover:bg-blue-600\"\r\n        >\r\n          Add Credit\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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"}